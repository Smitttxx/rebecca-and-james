// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Party {
  id          String   @id @default(cuid())
  code        String   @unique // Invitation code
  partyName   String
  musicRequests String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  guests      Guest[]

  @@map("parties")
}

model Guest {
  id                String   @id @default(cuid())
  firstName         String
  lastName          String
  fullName          String?  // Full name for display (e.g., "James-Thomas Cupit")
  guestTag          String?  // Role: Bride, Groom, Groomsmen, Ring Bearer, Child, Bride Family, Groom Family, Best Man, Bridesmaid, MOH, Friend, etc.
  isChild           Boolean  @default(false)
  useKidsMenu       Boolean  @default(false) // For children: true = kids menu, false = adult menu
  email             String?
  phone             String?
  isAttending       Boolean?
  dietaryRequirements String?
  allergies         String?  // Specific allergies
  starterSelection  String?
  mainSelection     String?
  dessertSelection  String?
  giftReceived      Boolean  @default(false)
  thankYouSent      Boolean  @default(false)
  confirmed         Boolean  @default(false)
  submittedAt       DateTime? // When RSVP was first submitted
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  // Relations
  partyId           String
  party             Party    @relation(fields: [partyId], references: [id], onDelete: Cascade)

  @@map("guests")
}

